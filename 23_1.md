```sql
CREATE TABLE Alumno(
    IdAlumno SERIAL PRIMARY KEY,
    Nombre VARCHAR(30),
    Apellido VARCHAR(30)
);

CREATE TABLE Universidad(
    IdUniversidad SERIAL PRIMARY KEY,
    Nombre VARCHAR(30),
    Tipo VARCHAR(10)
);

CREATE TABLE Curso(
    IdCurso SERIAL PRIMARY KEY,
    Nombre VARCHAR(30)
);

CREATE TABLE Universidad_Curso(
    IdUniversidad INT REFERENCES Universidad(IdUniversidad),
    IdCurso INT REFERENCES Curso(IdCurso),
    PRIMARY KEY (IdUniversidad, IdCurso)
);

CREATE TABLE Usuario(
    NombreUsuario VARCHAR(30) PRIMARY KEY,
    Contraseña VARCHAR(100),
    IdAlumno INT,
    FOREIGN KEY (IdAlumno) REFERENCES Alumno(IdAlumno)
);

CREATE TABLE Alumno_Curso(
    IdAlumno INT REFERENCES Alumno(IdAlumno),
    IdCurso INT REFERENCES Curso(IdCurso),
    PRIMARY KEY (IdAlumno, IdCurso)
);

CREATE TABLE Instructor(
    IdInstructor SERIAL PRIMARY KEY,
    Nombre VARCHAR(30),
    Apellido VARCHAR(30),
    HorarioInicio TIME,
    HorarioFinal TIME
);

CREATE TABLE UsuarioInstructor(
    NombreUsuario VARCHAR(30) PRIMARY KEY,
    Contraseña VARCHAR(100),
    IdInstructor INT,
    FOREIGN KEY (IdInstructor) REFERENCES Instructor(IdInstructor)
);

CREATE TABLE Servicio (
    IdServicio SERIAL PRIMARY KEY,
    HoraInicio TIME, -- o TIMESTAMP si necesitas incluir fecha
    Duracion TIME,
    CostoAsociado FLOAT,
    NombreUsuario VARCHAR(30),
    IdCurso INT,
    NombreUsuarioInstructor VARCHAR(30),
    FOREIGN KEY (NombreUsuario) REFERENCES Usuario(NombreUsuario),
    FOREIGN KEY (NombreUsuarioInstructor) REFERENCES UsuarioInstructor(NombreUsuario)
);

CREATE TABLE Evaluacion (
    Id SERIAL PRIMARY KEY,
    calificacion INT,
    comentario TEXT,
    IdServicio INT UNIQUE REFERENCES Servicio(IdServicio) ON DELETE CASCADE
);
```

```sql
//SE INSERTA LOS VALORES
-- Insertar datos en la tabla Alumno
INSERT INTO Alumno (Nombre, Apellido) VALUES ('Juan', 'Perez');
INSERT INTO Alumno (Nombre, Apellido) VALUES ('Ana', 'Gomez');
INSERT INTO Alumno (Nombre, Apellido) VALUES ('María', 'Gutiérrez');
INSERT INTO Alumno (Nombre, Apellido) VALUES ('Pedro', 'Ramírez');

-- Insertar datos en la tabla Usuario
INSERT INTO Usuario (NombreUsuario, Contraseña, IdAlumno) VALUES ('usuario3', 'contraseña3', 3);
INSERT INTO Usuario (NombreUsuario, Contraseña, IdAlumno) VALUES ('usuario4', 'contraseña4', 4);
INSERT INTO Usuario (NombreUsuario, Contraseña, IdAlumno) VALUES ('usuario1', 'contraseña1', 1);
INSERT INTO Usuario (NombreUsuario, Contraseña, IdAlumno) VALUES ('usuario2', 'contraseña2', 2);

-- Insertar datos en la tabla Universidad
INSERT INTO Universidad (Nombre, Tipo) VALUES ('Universidad X', 'Pública');
INSERT INTO Universidad (Nombre, Tipo) VALUES ('Universidad Y', 'Privada');
INSERT INTO Universidad (Nombre, Tipo) VALUES ('Universidad Z', 'Privada');
INSERT INTO Universidad (Nombre, Tipo) VALUES ('Universidad W', 'Pública');

-- Insertar datos en la tabla Curso
INSERT INTO Curso (Nombre) VALUES ('Matemáticas');
INSERT INTO Curso (Nombre) VALUES ('Historia');
INSERT INTO Curso (Nombre) VALUES ('Física');
INSERT INTO Curso (Nombre) VALUES ('Literatura');

-- Insertar datos en la tabla Instructor
INSERT INTO Instructor (Nombre, Apellido, HorarioInicio, HorarioFinal) VALUES ('Carlos', 'Lopez', '08:00:00', '17:00:00');
INSERT INTO Instructor (Nombre, Apellido, HorarioInicio, HorarioFinal) VALUES ('Ana', 'Rodriguez', '10:00:00', '19:00:00');
INSERT INTO Instructor (Nombre, Apellido, HorarioInicio, HorarioFinal) VALUES ('Luis', 'Martínez', '09:00:00', '18:00:00');
INSERT INTO Instructor (Nombre, Apellido, HorarioInicio, HorarioFinal) VALUES ('Elena', 'López', '11:00:00', '20:00:00');

-- Insertar datos en la tabla UsuarioInstructor
INSERT INTO UsuarioInstructor (NombreUsuario, Contraseña, IdInstructor) VALUES ('inst1', 'contraseña_inst1', 1);
INSERT INTO UsuarioInstructor (NombreUsuario, Contraseña, IdInstructor) VALUES ('inst2', 'contraseña_inst2', 2);
INSERT INTO UsuarioInstructor (NombreUsuario, Contraseña, IdInstructor) VALUES ('inst3', 'contraseña_inst3', 3);
INSERT INTO UsuarioInstructor (NombreUsuario, Contraseña, IdInstructor) VALUES ('inst4', 'contraseña_inst4', 4);

-- Insertar datos en la tabla Servicio
INSERT INTO Servicio (HoraInicio, Duracion, CostoAsociado, NombreUsuario, IdCurso, NombreUsuarioInstructor) 
VALUES ('10:00:00', '02:00:00', 50.0, 'usuario1', 1, 'inst1');
INSERT INTO Servicio (HoraInicio, Duracion, CostoAsociado, NombreUsuario, IdCurso, NombreUsuarioInstructor) 
VALUES ('12:00:00', '01:30:00', 40.0, 'usuario3', 2, 'inst3');

-- Insertar datos en la tabla Alumno_Curso
INSERT INTO Alumno_Curso (IdAlumno, IdCurso) VALUES (3, 1);
INSERT INTO Alumno_Curso (IdAlumno, IdCurso) VALUES (4, 2);

-- Insertar datos en la tabla Evaluacion
INSERT INTO Evaluacion (calificacion, comentario, IdServicio) VALUES (4, 'Buen servicio', 1);
INSERT INTO Evaluacion (calificacion, comentario, IdServicio) VALUES (5, 'Muy bueno', 2);
-- Insertar datos en la tabla Universidad_Curso
INSERT INTO Universidad_Curso (IdUniversidad, IdCurso) VALUES (1, 3);
INSERT INTO Universidad_Curso (IdUniversidad, IdCurso) VALUES (2, 4);
```
Implemente una sentencia sql que permita mostrar los alumnos de universidades publicas que hayan generado ingresos mayores a 100 soles a la plataforma, hayan tenido por lo menos 3 asesorias en la misma y cuyos horarios de de asesoria sea principlamente en las mañanas

```sql
SELECT
    A.Nombre AS NombreAlumno,
    A.Apellido AS ApellidoAlumno,
    UNI.Nombre AS NombreUniversidad,
    S.CostoAsociado AS IngresosGenerados,
    COUNT(E.Id) AS CantidadAsesorias
FROM
    Alumno A
JOIN
    Usuario U ON A.IdAlumno = U.IdAlumno
JOIN
    Alumno_Curso AC ON A.IdAlumno = AC.IdAlumno
JOIN
    Curso C ON AC.IdCurso = C.IdCurso
JOIN
    Universidad_Curso UC ON C.IdCurso = UC.IdCurso
JOIN
    Universidad UNI ON UC.IdUniversidad = UNI.IdUniversidad
JOIN
    Servicio S ON U.NombreUsuario = S.NombreUsuario
JOIN
    Evaluacion E ON S.IdServicio = E.IdServicio
JOIN
    UsuarioInstructor UI ON S.NombreUsuarioInstructor = UI.NombreUsuario
JOIN
    Instructor I ON UI.IdInstructor = I.IdInstructor
WHERE
    UNI.Tipo = 'Pública'
    AND S.CostoAsociado > 100
    AND E.calificacion IS NOT NULL
    AND I.HorarioInicio BETWEEN '08:00:00' AND '12:00:00' -- Suponiendo que "mañanas" es entre las 8:00 y las 12:00
GROUP BY
    A.Nombre, A.Apellido, UNI.Nombre, S.CostoAsociado
HAVING
    COUNT(E.Id) >= 3;
```
implemente un proceso batch que genere los intervalos horarios en los cuales se desarrollara cada una de las asesorias para un usuario dado . Considere como parametros el codigo y un rango de fechas.
si es necesario crea funciones
```sql
-- Crear una función para generar intervalos horarios
CREATE OR REPLACE FUNCTION generar_intervalos_horarios(
    usuario_nombre VARCHAR,
    fecha_inicio DATE,
    fecha_fin DATE
)
RETURNS TABLE (
    fecha DATE,
    hora_inicio TIME,
    hora_fin TIME
)
AS $$
DECLARE
    fecha_actual DATE := fecha_inicio;
BEGIN
    -- Iterar sobre las fechas y generar los intervalos horarios
    WHILE fecha_actual <= fecha_fin LOOP
        FOR hora_inicio IN '08:00:00'::TIME TO '17:00:00'::TIME BY '01:00:00'::interval LOOP
            -- Asumiendo que cada asesoría tiene una duración de 1 hora
            fecha := fecha_actual;
            RETURN NEXT;
        END FOR;
        fecha_actual := fecha_actual + 1; -- Avanzar al siguiente día
    END WHILE;
END;
$$ LANGUAGE PLPGSQL;

-- Ejemplo de uso de la función
SELECT * FROM generar_intervalos_horarios('usuario1', '2023-01-01', '2023-01-05');

```
